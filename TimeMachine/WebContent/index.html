<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Weather Time Machine</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css">
    <link rel="stylesheet" href="css/home.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.1/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-chart.js/1.1.1/angular-chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.1/angular-cookies.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.6.1/angular-sanitize.min.js"></script>
    <script src="js/app.js"></script>
  </head>
  <body ng-app="weatherTM">
    <nav class="navbar navbar-inverse navbar-fixed">
      <div class="container" ng-controller="NavbarController as nc">
        <div class="navbar-header pull-left">
          <a class="navbar-brand" href="./">Weather Time Machine</a>
        </div>
        <div class="navbar-header pull-right">
          <div class="btn navbar-btn navbar-link hidden">
            Test
          </div>
          <div ng-hide="user.loggedIn">
            <a class="btn btn-primary navbar-btn" id="btn-signin" href="login/">Sign In</a>
            <a class="btn btn-success navbar-btn" href="register/">Register</a>
          </div>
          <div ng-show="user.loggedIn">
            <a class="btn navbar-btn navbar-link">{{ user.username }}</a>
          </div>
        </div>
      </div>
    </nav>
    <div class="lg-image container" ng-controller="InputController as ic">
      <div class="row">
        <div class="col-sm-6" id="tagline">
          <h1 class="text-center">Explore weather in the past</h1>
        </div>
        <div class="col-sm-6">
          <form ng-submit="ic.submit()">
            <fieldset class="row">
              <div class="form-group col-sm-6">
                <label for="location">Enter a location</label>
                <div class="input-group">
                  <span class="input-group-addon">
                    <a ng-click="ic.geolocate()"><span class="glyphicon glyphicon-map-marker"></span></a>
                  </span>
                  <input type="text" name="location" class="form-control" ng-model="ic.location" placeholder="address, city, zipcode, etc." ng-keypress="($event.charCode==13)? ic.submit() : return">
                </div>
              </div>
              <div class="form-group col-sm-6">
                <label for="date">Enter a starting date</label>
                <input class="form-control" name="date" type="date" ng-model="ic.queryInfo.date" value="{{ ic.queryInfo.date | date: 'yyyy-MM-dd'}}" placeholder="yyyy-mm-dd" ng-keypress="($event.charCode==13)? ic.submit() : return">
              </div>
            </fieldset>
          </form>
        </div>
      </div>
    </div>
    <div class="container">
      <div ng-controller="ErrorController as errCtrl">
        <div class="alert alert-danger" ng-show="errCtrl.showError">
          <button type="button" class="close" ng-click="errCtrl.hideError()">&times;</button>
          {{ errCtrl.message }}
        </div>
      </div>
      <div ng-controller="DisplayController as dc">
        <h2>{{ location.longAddress }}</h2>
        <h4 class="text-primary">{{ location.date | date: 'longDate'}}</h4>
      </div>
      <div ng-controller="HistoryController as hc" class="panel panel-primary">
        <div class="panel-heading">
          <h4>Historical Events</h4>
        </div>
        <div class="panel-body">
          <ul>
            <li ng-repeat="item in hc.historyData.Events | limitTo: 5">
              <p><strong>{{ item.year }}</strong>: <span ng-bind-html="item.html"></span></p>
            </li>
          </ul>
        </div>
      </div>
      <div ng-controller="ChartController">
        <canvas id="line" class="chart chart-line" chart-data="data" chart-labels="labels" chart-series="series" chart-options="options" chart-dataset-override="datasetOverride" chart-click="onClick">
        </canvas>
      </div>
      <div ng-controller="darkSky as ds">
        <pre><code>{{ ds.data | json }}</code></pre>
      </div>
      <a class="pull-right" href="https://darksky.net/poweredby/" target="_blank"><h5>Powered by Dark Sky</h5></a>
    </div>
  </body>
</html>
